<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>51Degrees API Documentation: JavaScript</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="examplegrabber.js"></script>
<script type="text/javascript" src="testedversionsgrabber.js"></script>
<script type="text/javascript" src="search51.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="docs-main.min.css" rel="stylesheet" type="text/css" />
</head>
<body class="l-docs-index p-doxygen">
<div class="l-index__content">
<!--div id="top"--><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" class="g-header g-header--docs">
  <h1 class="c-brand">
  <a id="projectlogo" href="index.html" class="c-brand__link"><img class="c-brand__image" alt="Logo" src="logo-51Degrees-Docs.png" style="width:172px;"/></a>
  <span class="c-tagline">51Degrees API Documentation
   &#160;<span id="projectnumber">4.5</span>
  </span>
  </h1>
  <div id="projectalign" style="padding-left: 0.5em;">
  </div>
  <div id="main-nav"></div>
  <section class="g-search">
    <div class="c-search is-openable" id="searchOpenable">
    <form class="c-search__form">
      <div class="b-form-group b-form-group--with-icon">
        <label for="inputSearch" class="b-text--hidden">Search</label>
        <img src="icon-search.svg" class="b-icon" alt="Search" />
        <input type="text" class="c-search__input" id="inputSearch" onkeyup="javascript:onSearch(this,event.keyCode)" placeholder="Search" aria-label="Search">
      </div>
    </form>
    <div class="c-search__content" id="searchContent">
    </div>
  </div> 
  </section>
</div>
<!-- end header part -->
<main class="g-main">
<!-- Generated by Doxygen 1.8.15 -->
<!-- top -->
	<div class="g-docs__sidenav">																														         <nav id="nav-tree-contents" class="c-sidenav">																														     <h4 class="c-sidenav__heading">Documentation</h4>																									         <div id="nav-sync" class="sync"></div>
  <ul class="c-sidenav__list">																														     </ul>																																				   </nav>    </div><script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_device_detection__features__u_a_c_h__javascript.html','');});
/* @license-end */
</script>
<div id="doc-content" class="g-docs__content">
<div class="PageDoc"><div class="g-docs__header">
<div class="c-breadcrumb">
  <ul class="c-breadcrumb">
<li class="c-breadcrumb__item"><a class="c-breadcrumb__link" href="_device_detection__index.html">Device Detection</a></li><li class="c-breadcrumb__item"><a class="c-breadcrumb__link" href="_device_detection__features__index.html">Device Detection Features</a></li><li class="c-breadcrumb__item"><a class="c-breadcrumb__link" href="_device_detection__features__u_a_c_h__index.html">User-Agent Client Hints</a></li><li class="c-breadcrumb__item"><a class="c-breadcrumb__link" href="_device_detection__features__u_a_c_h__javascript.html">JavaScript</a></li>  </ul>
</div>
<h2 class="g-docs__page-title">JavaScript </h2></div><!--header-->
<div class="g-docs__inner">
<div class="g-docs__primary" id="primary">
<section class="g-docs__section"><h1 class="g-docs__section-heading">Introduction</h1>
<p>User-Agent Client Hints (UA-CH) values can be obtained using HTTP headers or a <a href="https://developer.mozilla.org/en-US/docs/Web/API/User-Agent_Client_Hints_API">JavaScript API</a>. This page explains how to use the JavaScript approach with our API.</p>
<p>The <a class="el" href="_device_detection__features__u_a_c_h__headers.html">UA-CH headers page</a> explains the alternative. The <a class="el" href="_device_detection__features__u_a_c_h__overview.html">Overview page</a> includes advice if you're unsure which approach to take.</p>
<p>Using the UA-CH JavaScript API is very simple if you are calling our Cloud Service directly. See details below.</p>
<p>Otherwise, if you are using one of our web integrations, you can use the 'Integrated' approach described below. If not, you'll need to use the 'non-integrated' approach instead.</p>
<h1 class="g-docs__section-heading">Cloud <a href="#UACH_Javscript_Cloud">#</a><a class="anchor" id="UACH_Javscript_Cloud"></a></h1>
<p>Firstly, ensure that the <code>JavascriptGetHighEntropyValues</code> property is selected when you create your Resource Key. This contains the JavaScript snippet to get the values from the UA-CH API on the client device.</p>
<p>If you are calling our Cloud Service directly from the client device, our solution will take care of the rest.</p>
<p>If you are calling our Cloud Service via our Pipeline API, hosted on your servers, then you'll also need to get this snippet to the client device. See the 'On-premise' section below for the two approaches to doing this.</p>
<h1 class="g-docs__section-heading">On-premise Pipeline API <a href="#UACH_Javscript_OnPrem">#</a><a class="anchor" id="UACH_Javscript_OnPrem"></a></h1>
<p>If you are using our Pipeline API on your server (either cloud or On-premise) then you'll need a way to get the necessary JavaScript to run on the client and get the values back to your server.</p>
<p>In either case, you need to ensure the <code>JavascriptGetHighEntropyValues</code> property is included in the results (all properties are included by default for On-premise).</p>
<h2>Integrated <a href="#UACH_Javascript_Integrated">#</a><a class="anchor" id="UACH_Javascript_Integrated"></a></h2>
<p>If you are using our <a class="el" href="_pipeline_api__features__web_integration.html">web integration</a> with <a class="el" href="_pipeline_api__features__client_side_evidence.html">client-side evidence</a> enabled, then this will take care of sending the snippet to the client device, getting the values back to the server and passing them into our API.</p>
<p>No additional configuration is required for either Cloud or On-premise solutions. The device detection engine natively processes the <code>getHighEntropyValues()</code> result when passed as evidence.</p>
<h2>Non-integrated <a href="#UACH_Javascript_NonIntegrated">#</a><a class="anchor" id="UACH_Javascript_NonIntegrated"></a></h2>
<p>If you don't want to, or can't, use the web integrations as described above, then you'll need to handle the steps of getting the values from the JavaScript API, transferring those to the server and adding them to the pipeline evidence values.</p>
<p>This will require a good knowledge of your production environment and how communication works between your client and server side code.</p>
<p>The following snippet demonstrates how to get the UA-CH values using JavaScript. The exact mechanism to get this value from the client device to your server will depend on your infrastructure. Once there, it will need to be added to the <a class="el" href="_pipeline_api__concepts__data__flow_data.html">flow data</a> evidence using either the <code>query.</code> or <code>cookie.</code> prefix:</p>
<div class="c-code__block c-code__block--outline"><div class="c-code__line">flowData.AddEvidence(&quot;query.51D_GetHighEntropyValues&quot;, b64Uach);</div><div class="c-code__line">// or</div><div class="c-code__line">flowData.AddEvidence(&quot;cookie.51D_GetHighEntropyValues&quot;, b64Uach);</div></div><div class="c-code__block c-code__block--outline"> <pre>
&lt;script type="text/javascript"&gt;
if (navigator.userAgentData) {
    navigator.userAgentData.getHighEntropyValues(
        ["model",
        "platform",
        "platformVersion",
        "fullVersionList"])
    .then((ua) =&gt; {
        // Convert to base64-encoded JSON
        // This string needs to be passed back to the server and added to evidence.
        // Use either query. or cookie. prefix, e.g.:
        // flowData.AddEvidence("query.51D_GetHighEntropyValues", b64Uach);
        var b64Uach = btoa(JSON.stringify(ua));
    });
}
&lt;/script&gt;
</pre> </div><p>No additional configuration is required for either Cloud or On-premise solutions. The device detection engine natively processes this evidence format, converting it to the equivalent <code>Sec-CH-UA-*</code> HTTP headers internally.</p>
<p>See the <a class="el" href="_device_detection__examples__getting_started__console__on_premise.html">Getting Started Console On-premise</a> example for a complete demonstration of this approach.</p>
<h1 class="g-docs__section-heading">Alternative Evidence Formats <a href="#UACH_Javascript_Alternatives">#</a><a class="anchor" id="UACH_Javascript_Alternatives"></a></h1>
<p>In addition to the <code>getHighEntropyValues()</code> JavaScript API result, the device detection engine supports the following alternative User-Agent Client Hints representations:</p>
<h2>Structured User Agent (SUA) <a href="#UACH_Javascript_SUA">#</a><a class="anchor" id="UACH_Javascript_SUA"></a></h2>
<p>The <a href="https://github.com/InteractiveAdvertisingBureau/openrtb2.x/blob/main/2.6.md#3229---object-useragent-">OpenRTB 2.6 specification</a> defines a Structured User Agent (<code>device.sua</code>) format for representing User-Agent Client Hints. This is commonly used in programmatic advertising and real-time bidding scenarios.</p>
<p>If you receive UA-CH data in the SUA format, you can pass it directly to the device detection engine with the <code>query.</code> or <code>cookie.</code> prefix:</p>
<div class="c-code__block c-code__block--outline"><div class="c-code__line">flowData.AddEvidence(&quot;query.51D_StructuredUserAgent&quot;, suaJsonString);</div></div><p>The SUA format looks like this:</p>
<div class="c-code__block c-code__block--outline"><div class="c-code__line">{</div><div class="c-code__line">  &quot;browsers&quot;: [</div><div class="c-code__line">    {&quot;brand&quot;: &quot;Chromium&quot;, &quot;version&quot;: [&quot;130&quot;, &quot;0&quot;, &quot;6723&quot;, &quot;92&quot;]},</div><div class="c-code__line">    {&quot;brand&quot;: &quot;Google Chrome&quot;, &quot;version&quot;: [&quot;130&quot;, &quot;0&quot;, &quot;6723&quot;, &quot;92&quot;]}</div><div class="c-code__line">  ],</div><div class="c-code__line">  &quot;platform&quot;: {&quot;brand&quot;: &quot;macOS&quot;, &quot;version&quot;: [&quot;15&quot;, &quot;1&quot;, &quot;0&quot;]},</div><div class="c-code__line">  &quot;mobile&quot;: 0,</div><div class="c-code__line">  &quot;model&quot;: &quot;&quot;,</div><div class="c-code__line">  &quot;architecture&quot;: &quot;arm&quot;</div><div class="c-code__line">}</div></div><p>For more details on OpenRTB integration, see the <a class="el" href="_device_detection__other_integrations__open_r_t_b_mappings.html">OpenRTB Mappings</a> page.</p>
<h2>Technical Details <a href="#UACH_Javascript_Technical">#</a><a class="anchor" id="UACH_Javascript_Technical"></a></h2>
<p>These alternative evidence formats (GHEV or SUA) are converted internally to the equivalent <code>Sec-CH-UA-*</code> HTTP headers before processing:</p>
<ul>
<li><code>Sec-CH-UA</code></li>
<li><code>Sec-CH-UA-Mobile</code></li>
<li><code>Sec-CH-UA-Platform</code></li>
<li><code>Sec-CH-UA-Model</code></li>
<li><code>Sec-CH-UA-Full-Version-List</code></li>
<li><code>Sec-CH-UA-Platform-Version</code></li>
<li><code>Sec-CH-UA-Arch</code></li>
<li><code>Sec-CH-UA-Bitness</code></li>
</ul>
<p>The conversion happens natively in the device detection engine (in the C layer), making it efficient and seamless. This eliminates the need for any additional pipeline elements or pre-processing steps that were required in earlier versions. </p>
</section></div><!-- PageDoc -->
</div><!-- primary -->
</div><!-- inner-->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<section id="nav-path" class="g-footer g-footer--docs"><!-- id is needed for treeview function! -->
    <p class="g-footer__copyright">Generated by
    <a href="http://www.doxygen.org/index.html">
    <b>doxygen</b></a> 1.8.15
  </p>
</section>
</div>
</main>
</div>
</body>
</html>
