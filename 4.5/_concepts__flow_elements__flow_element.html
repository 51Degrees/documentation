<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>51Degrees API Documentation: Flow Element</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="examplegrabber.js"></script>
<script type="text/javascript" src="testedversionsgrabber.js"></script>
<script type="text/javascript" src="search51.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="docs-main.min.css" rel="stylesheet" type="text/css" />
</head>
<body class="l-docs-index p-doxygen">
<div class="l-index__content">
<!--div id="top"--><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" class="g-header g-header--docs">
  <h1 class="c-brand">
  <a id="projectlogo" href="index.html" class="c-brand__link"><img class="c-brand__image" alt="Logo" src="logo-51Degrees-Docs.png" style="width:172px;"/></a>
  <span class="c-tagline">51Degrees API Documentation
   &#160;<span id="projectnumber">4.5</span>
  </span>
  </h1>
  <div id="projectalign" style="padding-left: 0.5em;">
  </div>
  <div id="main-nav"></div>
  <section class="g-search">
    <div class="c-search is-openable" id="searchOpenable">
    <form class="c-search__form">
      <div class="b-form-group b-form-group--with-icon">
        <label for="inputSearch" class="b-text--hidden">Search</label>
        <img src="icon-search.svg" class="b-icon" alt="Search" />
        <input type="text" class="c-search__input" id="inputSearch" onkeyup="javascript:onSearch(this,event.keyCode)" placeholder="Search" aria-label="Search">
      </div>
    </form>
    <div class="c-search__content" id="searchContent">
    </div>
  </div> 
  </section>
</div>
<!-- end header part -->
<main class="g-main">
<!-- Generated by Doxygen 1.8.15 -->
<!-- top -->
	<div class="g-docs__sidenav">																														         <nav id="nav-tree-contents" class="c-sidenav">																														     <h4 class="c-sidenav__heading">Documentation</h4>																									         <div id="nav-sync" class="sync"></div>
  <ul class="c-sidenav__list">																														     </ul>																																				   </nav>    </div><script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_concepts__flow_elements__flow_element.html','');});
/* @license-end */
</script>
<div id="doc-content" class="g-docs__content">
<div class="PageDoc"><div class="g-docs__header">
<div class="c-breadcrumb">
  <ul class="c-breadcrumb">
<li class="c-breadcrumb__item"><a class="c-breadcrumb__link" href="_concepts__index.html">Concepts</a></li><li class="c-breadcrumb__item"><a class="c-breadcrumb__link" href="_concepts__flow_elements__index.html">Flow Elements</a></li><li class="c-breadcrumb__item"><a class="c-breadcrumb__link" href="_concepts__flow_elements__flow_element.html">Flow Element</a></li>  </ul>
</div>
<h2 class="g-docs__page-title">Flow Element </h2></div><!--header-->
<div class="g-docs__inner">
<div class="g-docs__primary" id="primary">
<section class="g-docs__section"><h1 class="g-docs__section-heading">Introduction</h1>
<p>A <b>flow element</b> is an atomic processing component of a <a class="el" href="_concepts__pipeline.html">Pipeline</a>. It takes an input in the form of <a class="el" href="_concepts__data__evidence.html">evidence</a>, and outputs results in the form of <a class="el" href="_concepts__data__element_data.html">element data</a>. A <b>flow element</b> can be seen as a black box where the internal method of processing, and the way in which it is used externally, are decoupled, such that any <b>element</b> can be used in the same manner, regardless of its input, output, or method of processing. These are the building blocks of a <a class="el" href="_concepts__pipeline.html">Pipeline</a>, and do all the processing as instructed by the <a class="el" href="_concepts__pipeline.html">Pipeline</a> they reside in.</p>
<p>See the <a href="https://github.com/51Degrees/specifications/blob/main/pipeline-specification/conceptual-overview.md#flow-element">Specification</a> for more technical details.</p>
<h1 class="g-docs__section-heading">Creation</h1>
<p><b>Flow elements</b> are built using a corresponding <a class="el" href="_concepts__configuration__builders__element_builder.html">element builder</a>, which follows the fluent builder pattern. All configuration of an <b>element</b> occurs in the <a class="el" href="_concepts__configuration__builders__element_builder.html">element builder</a>. By convention, the configuration of an <b>element</b> is immutable once it has been built. However, this is not enforced, and is dependent on the implementation of each specific <b>element</b>.</p>
<h1 class="g-docs__section-heading">Processing</h1>
<p>The primary function of a <b>flow element</b> is to process data. Both the input (<a class="el" href="_concepts__data__evidence.html">evidence</a>) and output (<a class="el" href="_concepts__data__element_data.html">element data</a>) of the processing are contained in a single place called a <a class="el" href="_concepts__data__flow_data.html">flow data</a>.</p>
<p>The <b>flow element</b> typically uses the <a class="el" href="_concepts__data__evidence.html">evidence</a> contained within the supplied <a class="el" href="_concepts__data__flow_data.html">flow data</a> to determine the values it will populate in the resulting <a class="el" href="_concepts__data__element_data.html">element data</a>, which is then added to the <a class="el" href="_concepts__data__flow_data.html">flow data</a> as an output.</p>
<p>However, <b>flow elements</b> may also use existing <a class="el" href="_concepts__data__element_data.html">element data</a> from the <a class="el" href="_concepts__data__flow_data.html">flow data</a> as input, and are not required to populate any output data.</p>
<p><div class="dotgraph">
<iframe scrolling="no" frameborder="0" src="dot_flowelement-process.svg" width="352" height="203"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</p>
<p>For example, a 'user age' <b>element</b> might look for a date of birth in the <a class="el" href="_concepts__data__evidence.html">evidence</a>, and set the age of the user in an <a class="el" href="_concepts__data__element_data.html">element data</a> instance before adding the <a class="el" href="_concepts__data__element_data.html">element data</a> into the same <a class="el" href="_concepts__data__flow_data.html">flow data</a> which the <a class="el" href="_concepts__data__evidence.html">evidence</a> came from.</p>
<p><div class="dotgraph">
<iframe scrolling="no" frameborder="0" src="dot_ageelement-process.svg" width="434" height="208"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</p>
<h1 class="g-docs__section-heading">Hierarchy</h1>
<p>While an implementation can implement just <b>flow element</b>, useful functionality is built up in layers as shown below. Any of these layers can be added to by an implementation, depending on its requirements.</p>
<p>In languages which support inheritance, this is a structural hierarchy. In other languages, this may be more of a conceptual hierarchy, and not reflected directly in the code.</p>
<p><div class="dotgraph">
<iframe scrolling="no" frameborder="0" src="dot_flowelement-hierarchy.svg" width="506" height="450"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</p>
<h1 class="g-docs__section-heading">Properties</h1>
<p>The <a class="el" href="_concepts__data__element_data.html">element data</a> produced by an <b>element</b> contains values of <a class="el" href="_concepts__meta_data__element_properties.html">properties</a> based on the <a class="el" href="_concepts__data__evidence.html">evidence</a> provided. Each <b>element</b> has a set of <a class="el" href="_concepts__meta_data__element_properties.html">properties</a> it can populate values for.</p>
<p>The <a class="el" href="_concepts__meta_data__element_properties.html">properties</a> populated by an <b>element</b> can be queried directly to retrieve metadata relating to each property. The data available will vary by implementation but will typically include information such as the property name and data type.</p>
<h1 class="g-docs__section-heading">Evidence keys</h1>
<p>Each <b>element</b> can only make use of certain items of <a class="el" href="_concepts__data__evidence.html">evidence</a> during processing. In the <b>age element</b> example above, it expects a date of birth to be present in the <a class="el" href="_concepts__data__evidence.html">evidence</a>.</p>
<p>The items of <a class="el" href="_concepts__data__evidence.html">evidence</a> which an <b>element</b> can make use of are exposed via an <a class="el" href="_concepts__data__evidence_key_filter.html">evidence key filter</a>. This is also available in an aggregated form from the parent <a class="el" href="_concepts__pipeline.html">Pipeline</a>. (This would be equivalent to combining the <a class="el" href="_concepts__data__evidence_key_filter.html">evidence key filter</a> from each <b>element</b> of the <a class="el" href="_concepts__pipeline.html">Pipeline</a> individually).</p>
<p>Using an <a class="el" href="_concepts__data__evidence_key_filter.html">evidence key filter</a> means that instead of asking an <b>element</b> "which items of [evidence](@ref Concepts_Data_Evidence) do you want?", one would ask "do you want this item of [evidence](@ref Concepts_Data_Evidence)?". This gives an <b>element</b> a greater degree of flexibility with how it specifies the <a class="el" href="_concepts__data__evidence.html">evidence</a> that it accepts. For example, it allows an <b>element</b> to easily indicate that it can make use of any HTTP headers, regardless of the header name.</p>
<p><div class="dotgraph">
<iframe scrolling="no" frameborder="0" src="dot_flowelement-evidencekeys.svg" width="354" height="172"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</p>
<h1 class="g-docs__section-heading">Data keys</h1>
<p>Results of an <b>element's</b> processing are stored in the <a class="el" href="_concepts__data__flow_data.html">flow data</a>, keyed on the <b>element's</b> <a class="el" href="_concepts__data__element_data_key.html">element data key</a>. While not required, it is convention that each <b>element</b> has a unique key name. For example, our 'user age' example would likely have the key name 'user age'.</p>
<p>In addition to the name, an <a class="el" href="_concepts__data__element_data_key.html">element data key</a> also contains the type of <a class="el" href="_concepts__data__element_data.html">element data</a> that the element populates. Please note that this is only the case in languages which support this.</p>
<h1 class="g-docs__section-heading">Creating data</h1>
<p>When an <b>element</b> adds <a class="el" href="_concepts__data__element_data.html">element data</a> to a <a class="el" href="_concepts__data__flow_data.html">flow data</a>, it cannot be assumed that an <a class="el" href="_concepts__data__element_data.html">element data</a> does not already exist for the <b>element</b>. For this reason, an <b>element</b> contains an 'element data factory', which it gives to the <a class="el" href="_concepts__data__flow_data.html">flow data</a> when it asks for a new or existing <a class="el" href="_concepts__data__element_data.html">element data</a>. A method is called on the <a class="el" href="_concepts__data__flow_data.html">flow data</a>, giving the factory as an argument, and the <a class="el" href="_concepts__data__flow_data.html">flow data</a> returns either the <a class="el" href="_concepts__data__element_data.html">element data</a> previously created with the same key, or a new <a class="el" href="_concepts__data__element_data.html">element data</a> from the factory which it has added to its internal structure.</p>
<p> <div class="c-tabgroup">   <button class="b-btn b-btn--tab" onclick="showSnippet(this,'dotnet')">C#</button>   <button class="b-btn b-btn--tab" onclick="showSnippet(this,'java')">Java</button>   <div class="c-tabgroup__main" data-lang="none" style="display:block;">  Select a language to view an example of the 'get or add' method. </div>   <div class="c-tabgroup__main" data-lang="dotnet" style="display:none;">  In .NET, the 'factory' is an anonymous function given to the <b>element</b> at construction, taking a <a class="el" href="_concepts__data__flow_data.html">flow data</a> and returning an <a class="el" href="_concepts__data__element_data.html">element data</a>. </p><div class="c-code__block c-code__block--outline"><div class="c-code__line">var elementData = flowData.GetOrAdd(ElementDataKeyTyped, CreateElementData);</div></div><p>  </div>   <div class="c-tabgroup__main" data-lang="java" style="display:none;">  In Java, the 'factory' is an instance of a factory class given to the <b>element</b> at construction, taking a <a class="el" href="_concepts__data__flow_data.html">flow data</a> and returning an <a class="el" href="_concepts__data__element_data.html">element data</a>. </p><div class="c-code__block c-code__block--outline"><div class="c-code__line"><span class="c-code__keyword">final</span> TData aspectData = flowData.getOrAdd(getTypedDataKey(), getDataFactory());</div></div><p>  </div>   </div>  </p><h1 class="g-docs__section-heading">Scope</h1>
<p>By convention, an <b>element's</b> configuration is immutable once created. Although this is not enforced.</p>
<p>An <b>element</b> can be added to any number of <a class="el" href="_concepts__pipeline.html">Pipelines</a>. A <a class="el" href="_concepts__pipeline.html">Pipeline</a> is merely an organizational layer which instructs <b>elements</b> to carry out processing on a <a class="el" href="_concepts__data__flow_data.html">flow data</a>, so the <b>element</b> acts in isolation without the need to reference to the <a class="el" href="_concepts__pipeline.html">Pipeline</a>.</p>
<p>It is also possible for an <b>element</b> to be added more than once to the same <a class="el" href="_concepts__pipeline.html">Pipeline</a>. For example, an <b>element</b> which opens a persistent connection to a database, then closes it at another point in the <a class="el" href="_concepts__pipeline.html">Pipeline</a>, would exist more than once in the same <a class="el" href="_concepts__pipeline.html">Pipeline</a>. In this case, it is the responsibility of the <b>element</b> to ensure access to a <a class="el" href="_concepts__data__flow_data.html">flow data</a> isn't assumed as a fresh instance, and is accessed in a safe manner.</p>
<h1 class="g-docs__section-heading">Thread-safety</h1>
<p><b>Flow elements</b> are required to be thread-safe in languages that support multi-threaded operations. As multiple <a class="el" href="_concepts__pipeline.html">Pipelines</a> may be calling on an <b>element</b> to carry out processing simultaneously, they must be able to handle this.</p>
<p><b>Flow elements</b> also expose whether or not they will carry out concurrent operations, as the <a class="el" href="_concepts__pipeline.html">Pipeline</a> needs to know this.</p>
<p> <div class="c-tabgroup">   <button class="b-btn b-btn--tab" onclick="showSnippet(this,'dotnet')">C#</button>   <button class="b-btn b-btn--tab" onclick="showSnippet(this,'java')">Java</button>   <button class="b-btn b-btn--tab" onclick="showSnippet(this,'php')">PHP</button>   <button class="b-btn b-btn--tab" onclick="showSnippet(this,'node')">Node.js</button>   <div class="c-tabgroup__main" data-lang="none" style="display:block;">  Select a language to view language specific info on thread-safety. </div>   <div class="c-tabgroup__main" data-lang="dotnet" style="display:none;">  <b>Flow elements</b> in C# are generally immutable, so do not need thread safety built in directly, however they often alter a <a class="el" href="_concepts__data__flow_data.html">flow data</a> which must be done in a thread-safe way. Accessing the internal data structure is usually left up to the <a class="el" href="_concepts__data__flow_data.html">flow data</a> itself by exposing a thread safe <code>set</code> method to the <b>element</b>.  </div>   <div class="c-tabgroup__main" data-lang="java" style="display:none;">  <b>Flow elements</b> in Java are generally immutable, so do not need thread safety built in directly, however they often alter a <a class="el" href="_concepts__data__flow_data.html">flow data</a> which must be done in a thread-safe way. Accessing the internal data structure is usually left up to the <a class="el" href="_concepts__data__flow_data.html">flow data</a> itself by exposing a thread safe <code>set</code> method to the <b>element</b>.  </div>   <div class="c-tabgroup__main" data-lang="php" style="display:none;">  PHP runs in a single thread. Consequently, elements cannot run in parallel and concurrency issues are not a concern.  </div>   <div class="c-tabgroup__main" data-lang="node" style="display:none;">  Node runs in a single thread with asynchronous execution, except where worker threads are used. It is strongly recommended to not share a flow element object with a worker thread.  </div>   </div>  </p>
</section></div><!-- PageDoc -->
</div><!-- primary -->
</div><!-- inner-->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<section id="nav-path" class="g-footer g-footer--docs"><!-- id is needed for treeview function! -->
    <p class="g-footer__copyright">Generated by
    <a href="http://www.doxygen.org/index.html">
    <b>doxygen</b></a> 1.8.15
  </p>
</section>
</div>
</main>
</div>
</body>
</html>
