<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>51Degrees API Documentation: Frequently Asked Questions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="examplegrabber.js"></script>
<script type="text/javascript" src="search51.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="docs-main.min.css" rel="stylesheet" type="text/css" />
</head>
<body class="l-docs-index p-doxygen">
<div class="l-index__content">
<!--div id="top"--><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" class="g-header g-header--docs">
  <h1 class="c-brand">
  <a id="projectlogo" href="index.html" class="c-brand__link"><img class="c-brand__image" alt="Logo" src="logo-51Degrees-Docs.png" style="width:172px;"/></a>
  <span class="c-tagline">51Degrees API Documentation
   &#160;<span id="projectnumber">4.4</span>
  </span>
  </h1>
  <div id="projectalign" style="padding-left: 0.5em;">
  </div>
  <div id="main-nav"></div>
  <section class="g-search">
    <div class="c-search is-openable" id="searchOpenable">
    <form class="c-search__form">
      <div class="b-form-group b-form-group--with-icon">
        <label for="inputSearch" class="b-text--hidden">Search</label>
        <img src="icon-search.svg" class="b-icon" alt="Search" />
        <input type="text" class="c-search__input" id="inputSearch" onkeyup="javascript:onSearch(this,event.keyCode)" placeholder="Search" aria-label="Search">
      </div>
    </form>
    <div class="c-search__content" id="searchContent">
    </div>
  </div> 
  </section>
</div>
<!-- end header part -->
<main class="g-main">
<!-- Generated by Doxygen 1.8.15 -->
<!-- top -->
	<div class="g-docs__sidenav">																														         <nav id="nav-tree-contents" class="c-sidenav">																														     <h4 class="c-sidenav__heading">Documentation</h4>																									         <div id="nav-sync" class="sync"></div>
  <ul class="c-sidenav__list">																														     </ul>																																				   </nav>    </div><script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_info__f_a_qs.html','');});
/* @license-end */
</script>
<div id="doc-content" class="g-docs__content">
<div class="PageDoc"><div class="g-docs__header">
<div class="c-breadcrumb">
  <ul class="c-breadcrumb">
<li class="c-breadcrumb__item"><a class="c-breadcrumb__link" href="_info__index.html">Information</a></li><li class="c-breadcrumb__item"><a class="c-breadcrumb__link" href="_info__f_a_qs.html">Frequently Asked Questions</a></li>  </ul>
</div>
<h2 class="g-docs__page-title">Frequently Asked Questions </h2></div><!--header-->
<div class="g-docs__inner">
<div class="g-docs__primary" id="primary">
<section class="g-docs__section"><p><a class="anchor" id="Dotn_TempFiles"></a><a class="el" href="_info__f_a_qs.html#Dotn_TempFiles">#</a> </p><h4>Why are my temp files not being cleared when using the .NET Pipeline API?</h4>
<p>In .NET core, the finalizer is not called when a program exits as described on <a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/destructors">this page</a>. Some engines maintain files in a temporary directory while they are in operation and these can remain if a .NET core application using one of these engines is closed.</p>
<p>To workaround this problem, you can either:</p><ul>
<li>Use the <code>SetAutoDisposeElements</code> setting to ensure elements are disposed when the Pipeline is disposed.</li>
<li>Explicitly call dispose on all engines before exiting the program.</li>
</ul>
<p><a class="anchor" id="Node_TempFiles"></a><a class="el" href="_info__f_a_qs.html#Node_TempFiles">#</a> </p><h4>Why are my temp files not being cleared when using the Node.js Pipeline API?</h4>
<p>In Node.js, the finalizer is not called when a program exits. Some engines maintain files in a temporary directory while they are in operation and these can remain if a Node.js application using one of these engines is closed.</p>
<p>To workaround this problem, you can either:</p><ul>
<li>Set the <code>createTempDataCopy</code> to false to use the original file directly. Note that automatic updates cannot be enabled without either using a temporary file, or the <code>MaxPerformance</code> configuration option where the data file is copied into memory completely.</li>
<li>Set the <code>tempDataDir</code> to a directory which will be periodically cleaned up by another process e.g. <code>os.tmpdir()</code>.</li>
</ul>
<p>These is the options in the device detection on-premise engine, other third party engines may use different option naming.</p>
<p><a class="anchor" id="Dependencies_Glibc_Libatomic"></a><a class="el" href="_info__f_a_qs.html#Dependencies_Glibc_Libatomic">#</a> </p><h4>Why am I getting <code>version 'GLIBC_2.27' not found</code> or <code>libatomic.so.1: cannot open shared object file: No such file or directory</code> error when using 51Degrees Device Detection API package for On-premise?</h4>
<p>Most of 51Degrees Device Detection API packages for on-premise come with a set of prebuilt libraries. These libraries are built and linked in our build environment and require certain libraries with a minimum version to be available at the runtime. Please check out the <a class="el" href="_info__dependencies.html">dependencies</a> page to find out what dependencies are required to use our prebuilt packages. If you cannot modify your environment in order to provide the necessary dependencies, we suggest building your own packages from source in your target environment. The <a class="el" href="_info__dependencies.html">dependencies</a> page also includes links to the <code>README</code> files which detail how this can be done.</p>
<p>In the case of missing the <code>libatomic.so.1</code> library, make sure the <code>libatomic1</code> package is installed in your runtime environment.</p>
<p>If the issue is with version <code>GLIBC_2.27</code> not found, we recommend to build the package from source as <code>GLIBC</code> is the C standard library which is a core library to the Linux system and reinstalling it would potentially break your environment.</p>
<p><a class="anchor" id="PHP_ProcessManager"></a><a class="el" href="_info__f_a_qs.html#PHP_ProcessManager">#</a> </p><h4>Can I use PHP on-premise device detection with a process manager such as Apache MPM or php-fpm?</h4>
<p>When using our PHP Device Detection solution under a process manager such as Apache MPM, php-fpm, or any other process manager, the following restrictions are applied:</p><ul>
<li>Only <b>MaxPerformance</b> profile can be used.</li>
<li>Manual reload cannot be used. A full server restart is required.</li>
</ul>
<p>If Apache MPM is used:</p><ul>
<li>Only <b>prefork</b> mode can be used. These restrictions are due to the interaction between the native libraries used by our on-premise API and the way that OS handles and memory are handled by these process managers.</li>
</ul>
<p><a class="anchor" id="Python_MultiProcess"></a><a class="el" href="_info__f_a_qs.html#Python_MultiProcess">#</a> </p><h4>Can I use Python on-premise device detection in a multi-process environment?</h4>
<p>When using Device Detection API for on-premise in a spawned multi processes environment, the Pipeline object should be created for each process. If it is created as a global variable, the spawned process will re-initialize the variable and therefore, each process will have their own version of the pipeline object. In this environment the following settings should be used:</p><ul>
<li><code>create_temp_data_copy</code> set to <code>False</code></li>
<li><code>performance_profile</code> set to <code>MaxPerformance</code> Since a pipeline is created for each process, the memory cost of running the API will be multiplied by the number of processes.</li>
</ul>
<p>These restrictions are due to the interaction between the native libraries used by our on-premise API and the way that OS handles and memory are handled in a multi-process environment.</p>
<p><a class="anchor" id="UACH_DualEvidence"></a><a class="el" href="_info__f_a_qs.html#UACH_DualEvidence">#</a> </p><h4>Can I use User Agent Client Hints (UA-CH) at the same time as the User-Agent?</h4>
<p>Yes. In fact, this is recommended. The device detection algorithm will use the UA-CH data where possible. However, if a match cannot be found for the supplied UA-CH values, then the User-Agent will be used as a fall back.</p>
<p>If you are using a <a class="el" href="_features__web_integration.html">web integration</a> then the UA-CH and User-Agent will both be passed to the Pipeline automatically. Otherwise, you need to supply the available header values manually. See the <a class="el" href="_examples__device_detection__getting_started__console__index.html">getting started</a> examples for a demonstration of how to supply UA-CH evidence in parallel with the User-Agent.</p>
<p><a class="anchor" id="UserAgent_ContainsBetterData"></a><a class="el" href="_info__f_a_qs.html#UserAgent_ContainsBetterData">#</a> </p><h4>I've supplied the User-Agent in addition to UA-CH. The result returns unknown values for things that are clearly present in the User-Agent.</h4>
<p>UA-CH evidence always takes precedence over the User-Agent. In some scenarios, this means that additional detail that is available in the User-Agent will be ignored. For example:</p>
<ul>
<li><code>Sec-CH-UA-Platform</code> = <code>"Windows"</code></li>
<li><code>User-Agent</code> = <code>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:105.0) Gecko/20100101 Firefox/105.0</code></li>
</ul>
<p>The result from the API will return Windows, but the version number will be unknown; this is because the Sec-CH-UA-Platform-Version header has not been supplied.</p>
<p>Since UA-CH take precedence over the User-Agent (in this case, when Sec-CH-UA-Platform is used in preference to User-Agent), despite the User-Agent containing version information, the result from the API will not return any version information. To combat this, we recommend supplying all the Sec-CH-UA headers you need.</p>
<p>We take this approach because the version provided by the User-Agent is incorrect in some scenarios. For example, Windows 11 will always appear as Windows 10 in the User-Agent.</p>
<p>In addition, as Google press ahead with <a href="https://www.chromium.org/updates/ua-reduction/">deprecating the data</a> in parts of the User-Agent, the values presented will become less reliable. For example, all Android versions sending a User-Agent with 'Android 10' in it.</p>
<p>Therefore, we believe that returning 'Windows unknown version' or 'Android unknown version' is better than returning 'Windows 10' or 'Android 10' when the user may not actually be using those versions.</p>
<p>Be aware that Sec-CH-UA-Platform-Version, unlike Sec-CH-UA-Platform, will rarely be available in the first request. There is nothing we can do about this, as it is an intentional part of Google's design for UA-CH. For more details, see our <a class="el" href="_device_detection__features__user_agent_client_hints.html">UA-CH feature page</a>.</p>
<p>Finally, some of our users prefer to receive a platform version that is potentially incorrect, rather than an unknown platform version. If you would prefer this behavior, you can modify your system to only supply Sec-CH-UA-Platform to our API when you also have Sec-CH-UA-Platform-Version. This will cause it to fallback to using the platform version from the User-Agent when the complete data from UA-CH is not available.</p>
<p><a class="anchor" id="Error_OnPremise_DataFile"></a><a class="el" href="_info__f_a_qs.html#Error_OnPremise_DataFile">#</a> </p><h4>Why am I getting the following error message when updating the on-premise data file? <code>FiftyOne.Pipeline.Engines.Exceptions.DataUpdateException: 'Too many requests to '<a href="https://distributor.51degrees.com/api/v2/download?LicenseKeys=">https://distributor.51degrees.com/api/v2/download?LicenseKeys=</a>&amp;Download=True&amp;Type=HashV41' for engine 'DeviceDetectionHashEngine''</code></h4>
<p>There is a limit to the number of requests that you can make – only one request every 30 minutes can be made for each IP address.</p>
<p>The best solution is to only download the data file when you need to (ideally, once per day), or set up <a class="el" href="_features__automatic_datafile_updates.html">Automatic Data File Updates</a> for the latest data.</p>
<p>Alternatively, you can wait until after the 30-minute window to try again. However, you may encounter the error again.</p>
<p>If you have a production environment with a large number of nodes in a cluster, you need to take special care when designing your system to support data updates in a way that impact on our server and external bandwidth usage from your own systems. The <a class="el" href="_features__automatic_datafile_updates.html">automatic updates feature page</a> has a section at the bottom with some recommendations.</p>
<p><a class="anchor" id="Error_NetFramework_NetStandard"></a><a class="el" href="_info__f_a_qs.html#Error_NetFramework_NetStandard">#</a> </p><h4>When using the 51Degrees API with ASP.NET (.NET Framework), how do I resolve the error <code>CS0012: The type 'System.Object' is defined in an assembly that is not referenced. You must add a reference to assembly 'netstandard, Version=2.0.0.0, Culture=neutral, PublicKeyToken=cc7b13ffcd2ddd51'</code></h4>
<p>This happens because our API targets .NET Standard 2.0. You'll need to modify the 'compilation' element in your web.config file to add a reference to the netstandard assembly as shown below:</p>
<div class="c-code__block c-code__block--outline"><div class="c-code__line">&lt;compilation debug=&quot;true&quot; targetFramework=&quot;4.7.2&quot;&gt;</div><div class="c-code__line">  &lt;assemblies&gt;</div><div class="c-code__line">    &lt;add assembly=&quot;netstandard, Version=2.0.0.0, Culture=neutral, PublicKeyToken=cc7b13ffcd2ddd51&quot;/&gt;</div><div class="c-code__line">  &lt;/assemblies&gt;</div><div class="c-code__line">&lt;/compilation&gt;</div></div><p><a class="anchor" id="Error_NetFramework_NewerPackage"></a><a class="el" href="_info__f_a_qs.html#Error_NetFramework_NewerPackage">#</a> </p><h4>When using the 51Degrees API with .NET Framework, how do I resolve errors like <code>Could not load file or assembly 'Newtonsoft.Json, Version=11.0.0.0, Culture=neutral, PublicKeyToken=30ad4fe6b2a6aeed' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)</code></h4>
<p>These errors can be seen when a package you are referencing has a dependency on another package and you have a direct reference in your project to a different version of the same package. For example, if our package references Newtonsoft.Json version 11 and your project references Newtonsoft.Json version 13.</p>
<p>Sometimes, you'll need to reference the same version as the one required by your dependency. In many cases, this is not necessary though. Instead, you can tell the .NET Framework to handle calls to the version 11 dll by sending them to the version 13 dll.</p>
<p>You do this by configuring a binding redirect in the web.config file:</p>
<div class="c-code__block c-code__block--outline"><div class="c-code__line">&lt;runtime&gt;</div><div class="c-code__line">  &lt;assemblyBinding xmlns=&quot;urn:schemas-microsoft-com:asm.v1&quot;&gt;</div><div class="c-code__line">    &lt;dependentAssembly&gt;</div><div class="c-code__line">      &lt;assemblyIdentity name=&quot;Newtonsoft.Json&quot; publicKeyToken=&quot;30ad4fe6b2a6aeed&quot; /&gt;</div><div class="c-code__line">      &lt;bindingRedirect oldVersion=&quot;0.0.0.0-13.0.0.0&quot; newVersion=&quot;13.0.0.0&quot; /&gt;</div><div class="c-code__line">   &lt;/dependentAssembly&gt;</div><div class="c-code__line">  &lt;/assemblyBinding&gt;</div><div class="c-code__line">&lt;/runtime&gt;</div></div><p><a class="anchor" id="Error_NetFramework_NativeDll"></a><a class="el" href="_info__f_a_qs.html#Error_NetFramework_NativeDll">#</a> </p><h4>When using the 51Degrees API with .NET Framework, I get an error loading the native dll <code>Unable to load DLL 'FiftyOne.DeviceDetection.Hash.Engine.OnPremise.Native.dll': The specified module could not be found. (Exception from HRESULT: 0x8007007E)</code></h4>
<p>This error message makes it pretty clear what is happening, but resolving it can be tricky.</p>
<ol type="1">
<li>Ensure the server has the necessary <a class="el" href="_info__dependencies.html">dependencies</a> installed.</li>
<li>Use the correct version of the native dll. There are multiple versions of the native dll. Unlike .NET/.NET Core, .NET Framework is currently unable to resolve the correct binary at runtime. As a workaround, you'll need to copy the correct dll from the 'runtimes' folder to the root of the 'bin' folder. This can be done by adding the following snippet as a post build step for your project: <code>copy /Y "$(TargetDir)\runtimes\win-$(Platform)\native\FiftyOne.DeviceDetection.Hash.Engine.OnPremise.Native.dll" "$(TargetDir)\FiftyOne.DeviceDetection.Hash.Engine.OnPremise.Native.dll"</code> You need to make sure that the type of the native dll matches the type of the process that will be executing it. For example, if your production IIS instance is running in 32 bit mode, you'll need to make sure that you target the x86 platform for your production build. This will mean that the x86 binary is copied to the root of the bin folder and used at runtime.</li>
<li>IIS hosting &amp; dll location. When .NET loads a native dll, it first looks for the dll in the current application directory. For IIS, the current application directory is not the ASP.NET application’s bin folder, but the folder with the IIS executable. If .NET cannot find the dll in that location, it will follow the standard dll search order. Therefore, the native dll must be in one of the searched locations in order for device detection to work. We would usually recommend resolving this by updating the PATH environment variable to include the application directory where the dll is stored.</li>
</ol>
<p><a class="anchor" id="IsMobile_Sec-CH-UA-Mobile"></a><a class="el" href="_info__f_a_qs.html#IsMobile_Sec-CH-UA-Mobile">#</a> </p><h4>How do I know if I should serve a mobile version of the website when isMobile and Sec-CH-UA-Mobile do not match?</h4>
<p>Our IsMobile property indicates that the device is meant to function mostly on battery power and that its principal data connection is wireless. Meanwhile, the Sec-CH-UA-Mobile header field indicates to the server whether a user prefers a "mobile" user experience – it is not comparable with the IsMobile property.</p>
<p>You might see inconsistencies between values in our property and the header on some devices, such as tablets. Tablets function on battery power and are wireless, but the Sec-CH-UA-Mobile appears to be set to false by default.</p>
<p>Sites that wish to serve mobile-specific sites can do that by using the value of the Sec-CH-UA-Mobile header directly which is sent by default on every request. </p>
</section></div><!-- PageDoc -->
</div><!-- primary -->
</div><!-- inner-->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<section id="nav-path" class="g-footer g-footer--docs"><!-- id is needed for treeview function! -->
    <p class="g-footer__copyright">Generated by
    <a href="http://www.doxygen.org/index.html">
    <b>doxygen</b></a> 1.8.15
  </p>
</section>
</div>
</main>
</div>
</body>
</html>
