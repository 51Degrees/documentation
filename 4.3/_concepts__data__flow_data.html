<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>51Degrees API Documentation: Flow Data</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="examplegrabber.js"></script>
<script type="text/javascript" src="search51.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="docs-main.min.css" rel="stylesheet" type="text/css" />
</head>
<body class="l-docs-index p-doxygen">
<div class="l-index__content">
<!--div id="top"--><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" class="g-header g-header--docs">
  <h1 class="c-brand">
  <a id="projectlogo" href="index.html" class="c-brand__link"><img class="c-brand__image" alt="Logo" src="logo-51Degrees-Docs.png" style="width:172px;"/></a>
  <span class="c-tagline">51Degrees API Documentation
   &#160;<span id="projectnumber">4.3</span>
  </span>
  </h1>
  <div id="projectalign" style="padding-left: 0.5em;">
  </div>
  <div id="main-nav"></div>
  <section class="g-search">
    <div class="c-search is-openable" id="searchOpenable">
    <form class="c-search__form">
      <div class="b-form-group b-form-group--with-icon">
        <label for="inputSearch" class="b-text--hidden">Search</label>
        <img src="icon-search.svg" class="b-icon" alt="Search" />
        <input type="text" class="c-search__input" id="inputSearch" onkeyup="javascript:onSearch(this,event.keyCode)" placeholder="Search" aria-label="Search">
      </div>
    </form>
    <div class="c-search__content" id="searchContent">
    </div>
  </div> 
  </section>
</div>
<!-- end header part -->
<main class="g-main">
<!-- Generated by Doxygen 1.8.15 -->
<!-- top -->
	<div class="g-docs__sidenav">																														         <nav id="nav-tree-contents" class="c-sidenav">																														     <h4 class="c-sidenav__heading">Documentation</h4>																									         <div id="nav-sync" class="sync"></div>
  <ul class="c-sidenav__list">																														     </ul>																																				   </nav>    </div><script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_concepts__data__flow_data.html','');});
/* @license-end */
</script>
<div id="doc-content" class="g-docs__content">
<div class="PageDoc"><div class="g-docs__header">
<div class="c-breadcrumb">
  <ul class="c-breadcrumb">
<li class="c-breadcrumb__item"><a class="c-breadcrumb__link" href="_concepts__index.html">Concepts</a></li><li class="c-breadcrumb__item"><a class="c-breadcrumb__link" href="_concepts__data__index.html">Data</a></li><li class="c-breadcrumb__item"><a class="c-breadcrumb__link" href="_concepts__data__flow_data.html">Flow Data</a></li>  </ul>
</div>
<h2 class="g-docs__page-title">Flow Data </h2></div><!--header-->
<div class="g-docs__inner">
<div class="g-docs__primary" id="primary">
<section class="g-docs__section"><h1 class="g-docs__section-heading">Introduction</h1>
<p><b>Flow data</b> is a container that encapsulates all the data related to a single <a class="el" href="_concepts__pipeline.html">Pipeline</a> process request. This includes input and output data as well as metadata related to the processing such as the details of any errors that occurred.</p>
<h1 class="g-docs__section-heading">Data Structure</h1>
<p><b>Flow data</b> has several sub-containers that are used to segment the data that it contains:</p><ul>
<li><a class="el" href="_concepts__data__flow_data.html#Concepts_Data_FlowData_Evidence">Evidence</a></li>
<li><a class="el" href="_concepts__data__flow_data.html#Concepts_Data_FlowData_ElementData">Element data</a></li>
<li><a class="el" href="_concepts__data__flow_data.html#Concepts_Data_FlowData_Errors">Errors</a></li>
</ul>
<h2>Evidence<a class="anchor" id="Concepts_Data_FlowData_Evidence"></a></h2>
<p>Before the <a class="el" href="_concepts__data__flow_data.html">flow data</a> is passed into the <a class="el" href="_concepts__pipeline.html">Pipeline</a>, input data is supplied. We refer to this data as '<a class="el" href="_concepts__data__evidence.html">evidence</a>'. The <a class="el" href="_concepts__data__evidence.html">evidence</a> can be set manually or automatically by using a <a class="el" href="_features__web_integration.html">web integration</a> package (where available) for your web framework of choice.</p>
<p>Visit the <a class="el" href="_concepts__data__evidence.html">evidence</a> page for more details.</p>
<h2>Element Data<a class="anchor" id="Concepts_Data_FlowData_ElementData"></a></h2>
<p>The responses from each <a class="el" href="_concepts__flow_elements__flow_element.html">flow element</a> are stored in key/value pair structure within <b>flow data</b>. In each case, <a class="el" href="_concepts__data__element_data_key.html">the key</a> is the string key of the <a class="el" href="_concepts__flow_elements__flow_element.html">flow element</a> and the value is an <a class="el" href="_concepts__data__element_data.html">element data</a> instance. The <a class="el" href="_concepts__data__element_data.html">element data</a> structure is visible to each <a class="el" href="_concepts__flow_elements__flow_element.html">flow element</a> so one <a class="el" href="_concepts__flow_elements__flow_element.html">element</a> can use the result from another <a class="el" href="_concepts__flow_elements__flow_element.html">element</a> in its processing.</p>
<p>An example where this is required is the 51Degrees <a class="el" href="_concepts__flow_elements__cloud_engine.html">cloud engines</a>. First, an <a class="el" href="_concepts__flow_elements__flow_element.html">element</a> makes an HTTP request to the cloud and stores the JSON response in the <b>flow data</b>. Later, another <a class="el" href="_concepts__flow_elements__flow_element.html">element</a> takes that JSON response and parses it to populate a strongly typed object with values for the specific <a class="el" href="_concepts__terminology.html#Concepts_Terminology_Aspect">aspect</a> it is concerned with.</p>
<p>Visit the <a class="el" href="_concepts__data__element_data.html">element data</a> page for more details.</p>
<h2>Errors<a class="anchor" id="Concepts_Data_FlowData_Errors"></a></h2>
<p>The errors collection stores the details of any errors that occur during processing. The language's default exception handling mechanism will be used to catch and record any exceptions that occur when a <a class="el" href="_concepts__flow_elements__flow_element.html">flow element</a> is processing. However, processing of later <a class="el" href="_concepts__flow_elements__flow_element.html">flow elements</a> will continue as normal.</p>
<p>By default, once all <a class="el" href="_concepts__flow_elements__flow_element.html">flow elements</a> have been processed, an exception will be thrown with details of any errors that have occurred.</p>
<p>The <a class="el" href="_concepts__configuration__builders__pipeline_builder.html">pipeline builder</a> has an option to modify this behavior so that exceptions are totally suppressed. In this situation, the caller is responsible for handling any exceptions by checking the errors collection after processing.</p>
<h1 class="g-docs__section-heading">Life Cycle</h1>
<h2>Creation</h2>
<p><b>Flow data</b> is only ever created by a <a class="el" href="_concepts__pipeline.html">Pipeline</a>, when the <code>CreateFlowData</code> method is called. This allows the <a class="el" href="_concepts__pipeline.html">Pipeline</a> to create the <b>flow data</b> internal data structures using implementations that are most appropriate for the configuration of the <a class="el" href="_concepts__flow_elements__flow_element.html">flow elements</a> in the <a class="el" href="_concepts__pipeline.html">Pipeline</a>.</p>
<p>For example, thread-safe but slower data collections only need to be used if the <a class="el" href="_concepts__pipeline.html">Pipeline</a> is configured to execute <a class="el" href="_concepts__flow_elements__flow_element.html">elements</a> in <a class="el" href="_features__parallel_execution.html">parallel</a>.</p>
<h2>Disposal / Cleanup</h2>
<p><b>Flow data</b> disposal should be left up to the garbage collector. This enures that any resource which may still be needed (e.g. if it has been cached) is freed at the correct point.</p>
<p>There are exceptions where <b>Flow data</b> must be disposed immediately after it is no longer needed. This is because the garbage collector does not free the resource fast enough under high load and cause out of memory exception. Two languages where this is required are Java and C#.</p>
<p> <div class="c-tabgroup">   <button class="b-btn b-btn--tab" onclick="showSnippet(this,'dotnet')">C#</button>   <button class="b-btn b-btn--tab" onclick="showSnippet(this,'java')">Java</button>   <div class="c-tabgroup__main" data-lang="none" style="display:block;">  Select a language. </div>   <div class="c-tabgroup__main" data-lang="dotnet" style="display:none;">  In .NET, try-with-resource pattern is done as below. </p><div class="c-code__block c-code__block--outline"><div class="c-code__line">// Create the FlowData instance.</div><div class="c-code__line">using (var data = pipeline.CreateFlowData())</div><div class="c-code__line">{</div><div class="c-code__line">   ...</div><div class="c-code__line">}</div></div><p>  </div>   <div class="c-tabgroup__main" data-lang="java" style="display:none;">  In Java, try-with-resource pattern is done as below.</p>
<div class="c-code__block c-code__block--outline"><div class="c-code__line">// A try-with-resource block MUST be used for </div><div class="c-code__line">// the FlowData instance. This ensures that native resources created</div><div class="c-code__line">// by the device detection engine are freed.</div><div class="c-code__line">try (FlowData data = pipeline.createFlowData()) {</div><div class="c-code__line">    ...</div><div class="c-code__line">}</div></div><p>  </div>   </div> </p>
<h1 class="g-docs__section-heading">Thread Safety<a class="anchor" id="Concepts_Data_FlowData_ThreadSafety"></a></h1>
<p> <div class="c-tabgroup">   <button class="b-btn b-btn--tab" onclick="showSnippet(this,'dotnet')">C#</button>   <button class="b-btn b-btn--tab" onclick="showSnippet(this,'java')">Java</button>   <button class="b-btn b-btn--tab" onclick="showSnippet(this,'php')">PHP</button>   <button class="b-btn b-btn--tab" onclick="showSnippet(this,'node')">Node.js</button>   <div class="c-tabgroup__main" data-lang="none" style="display:block;">  Select a language. </div>   <div class="c-tabgroup__main" data-lang="dotnet" style="display:none;">  In .NET, by default, the non-thread-safe <code>Dictionary</code> class is used for both <a class="el" href="_concepts__data__element_data.html">element data</a> and <a class="el" href="_concepts__data__evidence.html">evidence</a>.</p>
<p>In both cases, this can be overridden to use another <code>IDictionary</code> implementation such as the thread-safe <code>ConcurrentDictionary</code>.</p>
<p>The errors collection uses the List class. This is not thread-safe. As performance is less of an issue with this collection, a simple lock is used to synchronize items being added to the list.  </div>   <div class="c-tabgroup__main" data-lang="java" style="display:none;">  In Java, by default, the non-thread-safe <code>TreeMap</code> class is used for <a class="el" href="_concepts__data__element_data.html">element data</a> and the thread-safe <code>ConcurrentSkipListMap</code> class for <a class="el" href="_concepts__data__evidence.html">evidence</a>.</p>
<p>In both cases, this can be overridden to use another <code>Map</code> implementation such as the thread-safe <code>ConcurrentHashMap</code>. However, it should be noted that not all <code>Map</code> implementations support case insensitivity.  </div>   <div class="c-tabgroup__main" data-lang="php" style="display:none;">  PHP runs in a single thread. Consequently, elements cannot run in parallel and concurrency issues are not a concern.  </div>   <div class="c-tabgroup__main" data-lang="node" style="display:none;">  Node runs in a single thread with asynchronous execution, except where worker threads are used. It is strongly recommended to not share an element data object with a worker thread.  </div>   </div>  </p>
</section></div><!-- PageDoc -->
</div><!-- primary -->
</div><!-- inner-->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<section id="nav-path" class="g-footer g-footer--docs"><!-- id is needed for treeview function! -->
    <p class="g-footer__copyright">Generated by
    <a href="http://www.doxygen.org/index.html">
    <b>doxygen</b></a> 1.8.15
  </p>
</section>
</div>
</main>
</div>
</body>
</html>
