<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>51Degrees Pipeline Documentation: Pipeline</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="examplegrabber.js"></script>
<script type="text/javascript" src="search51.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="docs-main.min.css" rel="stylesheet" type="text/css" />
</head>
<body class="l-docs-index p-doxygen">
<div class="l-index__content">
<!--div id="top"--><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" class="g-header g-header--docs">
  <h1 class="c-brand">
  <a id="projectlogo" href="index.html" class="c-brand__link"><img class="c-brand__image" alt="Logo" src="logo-51Degrees-Docs.png"/></a>
  <span class="c-tagline">51Degrees Pipeline Documentation
   &#160;<span id="projectnumber">4.1</span>
  </span>
  </h1>
  <div id="projectalign" style="padding-left: 0.5em;">
  </div>
  <div id="main-nav"></div>
  <section class="g-search">
    <div class="c-search is-openable" id="searchOpenable">
    <form class="c-search__form">
      <div class="b-form-group b-form-group--with-icon">
        <label for="inputSearch" class="b-text--hidden">Search</label>
        <img src="icon-search.svg" class="b-icon" alt="Search" />
        <input type="text" class="c-search__input" id="inputSearch" onkeyup="javascript:onSearch(this,event.keyCode)" placeholder="Search" aria-label="Search">
      </div>
    </form>
    <div class="c-search__content" id="searchContent">
    </div>
  </div> 
  </section>
</div>
<!-- end header part -->
<main class="g-main">
<!-- Generated by Doxygen 1.8.15 -->
<!-- top -->
	<div class="g-docs__sidenav">																														         <nav id="nav-tree-contents" class="c-sidenav">																														     <h4 class="c-sidenav__heading">Documentation</h4>																									         <div id="nav-sync" class="sync"></div>
  <ul class="c-sidenav__list">																														     </ul>																																				   </nav>    </div><script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_concepts__pipeline.html','');});
/* @license-end */
</script>
<div id="doc-content" class="g-docs__content">
<div class="PageDoc"><div class="g-docs__header">
<div class="c-breadcrumb">
  <ul class="c-breadcrumb">
<li class="c-breadcrumb__item"><a class="c-breadcrumb__link" href="_concepts__index.html">Concepts</a></li><li class="c-breadcrumb__item"><a class="c-breadcrumb__link" href="_concepts__pipeline.html">Pipeline</a></li>  </ul>
</div>
<h2 class="g-docs__page-title">Pipeline </h2></div><!--header-->
<div class="g-docs__inner">
<div class="g-docs__primary" id="primary">
<section class="g-docs__section"><h1 class="g-docs__section-heading">Introduction</h1>
<p>A <b>Pipeline</b> is a customizable data processing system. At the most basic level, input data is supplied in the form of <a class="el" href="_concepts__data__evidence.html">evidence</a>. One or more <a class="el" href="_concepts__flow_elements__flow_element.html">flow elements</a> in the <b>Pipeline</b> then perform processing based on that <a class="el" href="_concepts__data__evidence.html">evidence</a> and optionally, populate data values that are required by the user.</p>
<p>The incoming <a class="el" href="_concepts__data__evidence.html">evidence</a> is usually related to a <a class="el" href="_concepts__terminology.html#Concepts_Terminology_WebRequest">web request</a>, for example the HTTP headers, cookies, source IP address or values from the query string. The <a class="el" href="_concepts__data__evidence.html">evidence</a> is carried through the <b>Pipeline</b> to the <a class="el" href="_concepts__flow_elements__flow_element.html">elements</a> by a <a class="el" href="_concepts__data__flow_data.html">flow data</a> instance. The <a class="el" href="_concepts__data__flow_data.html">flow data</a> structure encapsulates all input and output data associated with a single <b>Pipeline</b> process request.</p>
<h1 class="g-docs__section-heading">Creation</h1>
<p>A <b>Pipeline</b> is built using a <a class="el" href="_concepts__configuration__builders__pipeline_builder.html">pipeline builder</a> utilizing the fluent builder pattern. By adding <a class="el" href="_concepts__flow_elements__flow_element.html">flow elements</a> to the <b>Pipeline</b>, the nature of the processing it will carry out is defined.</p>
<p>Once created, a <b>Pipeline</b> is immutable, i.e. the <a class="el" href="_concepts__flow_elements__flow_element.html">flow elements</a> it contains and the order in which they execute cannot be changed. Individual <a class="el" href="_concepts__flow_elements__flow_element.html">flow elements</a> may be immutable, or not, based upon their individual implementations.</p>
<p>As an alternative to configuring a <b>Pipeline</b> using a builder, configuration can be supplied from a file. Depending on the language features and conventions, this could be formatted as either JSON or XML. This allows the <b>Pipeline</b> to be configurable at runtime without recompiling the code. This is the default operation for <a class="el" href="_features__web_integration.html">web integrations</a>, but can be used for any other use-case as well. For more on this, see the <a class="el" href="_concepts__configuration__builders__build_from_configuration.html">build from configuration</a> section, and the <a class="el" href="_examples__device_detection__configure_from_file__index.html">configure from file</a> example.</p>
<h1 class="g-docs__section-heading">Processing</h1>
<p>The flow of a <b>Pipeline's</b> operation starts with the creation of a <a class="el" href="_concepts__data__flow_data.html">flow data</a>. This is created from the <b>Pipeline</b>, and is specific to it. Each <a class="el" href="_concepts__data__flow_data.html">flow data</a> instance can only be processed using the <b>Pipeline</b> that created it.</p>
<p>Next, <a class="el" href="_concepts__data__evidence.html">evidence</a> is added to the <a class="el" href="_concepts__data__flow_data.html">flow data</a> ready to be processed.</p>
<p>Finally, the <a class="el" href="_concepts__data__flow_data.html">flow data</a> is processed. Doing this sends the data (along with all the <a class="el" href="_concepts__data__evidence.html">evidence</a> it now contains) through the <b>Pipeline</b>. Each <a class="el" href="_concepts__flow_elements__flow_element.html">flow element</a> will receive the <a class="el" href="_concepts__data__flow_data.html">flow data</a> and do its processing before optionally updating the <a class="el" href="_concepts__data__flow_data.html">flow data</a> with new values.</p>
<p>Note that the order of execution of <a class="el" href="_concepts__flow_elements__flow_element.html">flow elements</a> is decided when the <b>Pipeline</b> is created. By default, <a class="el" href="_concepts__flow_elements__flow_element.html">flow elements</a> are executed sequentially in the order they are added. However, if the <a class="el" href="_info__feature_matrix.html">language supports</a> it, two or more <a class="el" href="_concepts__flow_elements__flow_element.html">flow elements</a> can also be executed in <a class="el" href="_features__parallel_execution.html">parallel</a> within the overall sequential structure.</p>
<p>Additionally, the <b>Pipeline</b> may offer <a class="el" href="_features__asynchronous_execution.html">asynchronous</a> execution or a <a class="el" href="_features__lazy_loading.html">lazy loading</a> capability for individual <a class="el" href="_concepts__flow_elements__flow_element.html">flow elements</a>. These features are also <a class="el" href="_info__feature_matrix.html">language dependent</a>.</p>
<p>Regardless of the method of execution and configuration, after processing the <a class="el" href="_concepts__data__flow_data.html">flow data</a> will contain the results, which can then be accessed by the caller.</p>
<p><div class="dotgraph">
<iframe scrolling="no" frameborder="0" src="dot_basic-pipeline-flow.svg" width="190" height="172"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</p>
<h1 class="g-docs__section-heading">Public Access</h1>
<p>Other than the creation of a new <a class="el" href="_concepts__data__flow_data.html">flow data</a>, there are very few other publicly accessible parts of the <b>Pipeline</b>.</p>
<p><a class="el" href="_concepts__flow_elements__flow_element.html">Flow elements</a> inside the <b>Pipeline</b> are accessible as a read-only collection, and can also be retrieved individually if needed.</p>
<p>All <a class="el" href="_concepts__meta_data__element_properties.html">element properties</a> that the <b>Pipeline's</b> <a class="el" href="_concepts__flow_elements__flow_element.html">flow elements</a> can populate are also exposed in one place. This enables easy iteration over all <a class="el" href="_concepts__meta_data__element_properties.html">element properties</a>.</p>
<p> <div class="c-tabgroup">   <button class="b-btn b-btn--tab" onclick="showSnippet(this,'dotnet')">C#</button>   <button class="b-btn b-btn--tab" onclick="showSnippet(this,'java')">Java</button>   <button class="b-btn b-btn--tab" onclick="showSnippet(this,'php')">PHP</button>   <button class="b-btn b-btn--tab" onclick="showSnippet(this,'node')">Node.js</button>   <div class="c-tabgroup__main" data-lang="none" style="display:block;">  Select a language to view language specific iterator example. </div>   <div class="c-tabgroup__main" data-lang="dotnet" style="display:none;">  Iterate over all <a class="el" href="_concepts__meta_data__element_properties.html">properties</a> in the <b>Pipeline</b>. </p><div class="c-code__block c-code__block--outline"><div class="c-code__line"><span class="c-code__keywordflow">foreach</span> (var elementProperties <span class="c-code__keywordflow">in</span> pipeline.ElementAvailableProperties)</div><div class="c-code__line">{</div><div class="c-code__line">    var elementName = elementProperties.Key;</div><div class="c-code__line">    </div><div class="c-code__line">    <span class="c-code__keywordflow">foreach</span> (var item <span class="c-code__keywordflow">in</span> elementProperties.Value)</div><div class="c-code__line">    {</div><div class="c-code__line">        var propertyName = item.Key;</div><div class="c-code__line">        var <span class="c-code__keyword">property</span> = item.Value;</div><div class="c-code__line">    }</div><div class="c-code__line">}</div></div><p>  </div>   <div class="c-tabgroup__main" data-lang="java" style="display:none;">  Iterate over all <a class="el" href="_concepts__meta_data__element_properties.html">properties</a> in the <b>Pipeline</b>. </p><div class="c-code__block c-code__block--outline"><div class="c-code__line"><span class="c-code__keywordflow">for</span> (Map.Entry&lt;String, Map&lt;String, ElementPropertyMetaData&gt;&gt; elementProperties</div><div class="c-code__line">    : pipeline.getElementAvailableProperties().entrySet()) {</div><div class="c-code__line">    </div><div class="c-code__line">    String elementName = elementProperties.getKey();</div><div class="c-code__line">    </div><div class="c-code__line">    <span class="c-code__keywordflow">for</span> (Map.Entry&lt;String, ElementPropertyMetaData&gt; item</div><div class="c-code__line">        : elementProperties.getValue().entrySet()) {</div><div class="c-code__line">        </div><div class="c-code__line">        String propertyName = item.getKey();</div><div class="c-code__line">        ElementPropertyMetaData <span class="c-code__keyword">property</span> = item.getValue();</div><div class="c-code__line">    }</div><div class="c-code__line">}</div></div><p>  </div>   <div class="c-tabgroup__main" data-lang="php" style="display:none;">  <b>todo</b>  </div>   <div class="c-tabgroup__main" data-lang="node" style="display:none;">  <b>todo</b>  </div> </p>
<p>An <a class="el" href="_concepts__data__evidence_key_filter.html">evidence key filter</a> is also exposed. This aggregates all the evidence keys accepted by all the <a class="el" href="_concepts__flow_elements__flow_element.html">flow elements</a> within the <b>Pipeline</b>. This can be used by the caller to check which items of <a class="el" href="_concepts__data__evidence.html">evidence</a> could affect the result of processing.</p>
<h1 class="g-docs__section-heading">Internals</h1>
<p>The structure of the <a class="el" href="_concepts__flow_elements__flow_element.html">flow elements</a> within the <b>Pipeline</b>, and the <a class="el" href="_concepts__data__flow_data.html">flow data</a> which it creates, is determined by how it is created.</p>
<p>Consider an example where <a class="el" href="_concepts__flow_elements__flow_element.html">flow elements</a> <b>E1</b> and <b>E2</b> are added to the <b>Pipeline</b> individually in that order.</p>
<p><div class="dotgraph">
<iframe scrolling="no" frameborder="0" src="dot_pipeline-process.svg" width="560" height="130"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</p>
<p><b>E1</b> will carry out its processing on the <a class="el" href="_concepts__data__flow_data.html">flow data</a>, then once it is finished, <b>E2</b> will do the same. In this scenario, the <b>Pipeline</b> 'knows' that the <a class="el" href="_concepts__data__flow_data.html">flow data</a> will not be written to by multiple threads. As such, the <a class="el" href="_concepts__data__flow_data.html">flow data</a> created by the <b>Pipeline</b> will not be thread-safe but will have slightly improved performance.</p>
<p>Now consider an example where both <b>E1</b> and <b>E2</b> are added in parallel.</p>
<p><div class="dotgraph">
<iframe scrolling="no" frameborder="0" src="dot_pipeline-parallel-process.svg" width="487" height="203"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</p>
<p>In this case, both will carry out their processing at the same time. This time, the <a class="el" href="_concepts__data__flow_data.html">flow data</a> which the <b>Pipeline</b> creates will be thread-safe for writing as it is possible that both <b>E1</b> and <b>E2</b> will attempt to write their results to the FlowData at the same time.</p>
<p> <div class="c-tabgroup">   <button class="b-btn b-btn--tab" onclick="showSnippet(this,'dotnet')">C#</button>   <button class="b-btn b-btn--tab" onclick="showSnippet(this,'java')">Java</button>   <button class="b-btn b-btn--tab" onclick="showSnippet(this,'php')">PHP</button>   <button class="b-btn b-btn--tab" onclick="showSnippet(this,'node')">Node.js</button>   <div class="c-tabgroup__main" data-lang="none" style="display:block;">  Select a language to view language specific build example. </div>   <div class="c-tabgroup__main" data-lang="dotnet" style="display:none;">  Build a <b>Pipeline</b> with two <a class="el" href="_concepts__flow_elements__flow_element.html">flow elements</a> in sequence. </p><div class="c-code__block c-code__block--outline"><div class="c-code__line">IPipeline pipeline = <span class="c-code__keyword">new</span> PipelineBuilder(loggerFactory)</div><div class="c-code__line">    .AddFlowElement(E1)</div><div class="c-code__line">    .AddFlowElement(E2)</div><div class="c-code__line">    .Build();</div></div><p> Build a <b>Pipeline</b> with two <a class="el" href="_concepts__flow_elements__flow_element.html">flow elements</a> in parallel. </p><div class="c-code__block c-code__block--outline"><div class="c-code__line">IPipeline pipeline = <span class="c-code__keyword">new</span> PipelineBuilder(loggerFactory)</div><div class="c-code__line">    .AddFlowElementsParallel(E1, E2)</div><div class="c-code__line">    .Build();</div></div><p>  </div>   <div class="c-tabgroup__main" data-lang="java" style="display:none;">  Build a <b>Pipeline</b> with two <a class="el" href="_concepts__flow_elements__flow_element.html">flow elements</a> in sequence. </p><div class="c-code__block c-code__block--outline"><div class="c-code__line">Pipeline pipeline = <span class="c-code__keyword">new</span> PipelineBuilder(loggerFactory)</div><div class="c-code__line">    .addFlowElement(E1)</div><div class="c-code__line">    .addFlowElement(E2)</div><div class="c-code__line">    .build();</div></div><p> Build a <b>Pipeline</b> with two <a class="el" href="_concepts__flow_elements__flow_element.html">flow elements</a> in parallel. </p><div class="c-code__block c-code__block--outline"><div class="c-code__line">Pipeline pipeline = <span class="c-code__keyword">new</span> PipelineBuilder(loggerFactory)</div><div class="c-code__line">    .addFlowElementsParallel(<span class="c-code__keyword">new</span> FlowElement[]{ E1, E2 })</div><div class="c-code__line">    .build();</div></div><p>  </div>   <div class="c-tabgroup__main" data-lang="php" style="display:none;">  <b>todo</b>  </div>   <div class="c-tabgroup__main" data-lang="node" style="display:none;">  <b>todo</b>  </div> </p>
<h1 class="g-docs__section-heading">Lifecycle</h1>
<p>A <b>Pipeline</b> is the second thing to be created, after the <a class="el" href="_concepts__flow_elements__flow_element.html">flow elements</a> which it contains. It then exists for as long as processing is required. When a <b>Pipeline</b> is disposed of, it can optionally dispose of the <a class="el" href="_concepts__flow_elements__flow_element.html">flow elements</a> within too. This makes managing the lifetime of the <a class="el" href="_concepts__flow_elements__flow_element.html">flow elements</a> easy, however this should not be done if the same <a class="el" href="_concepts__flow_elements__flow_element.html">flow element</a> instances have also been added to another <b>Pipeline</b>.</p>
<p>If an attempt is made to process a <a class="el" href="_concepts__data__flow_data.html">flow data</a> from a <b>Pipeline</b> which has since been disposed, an error will occur. The <b>Pipeline</b> which creates a <a class="el" href="_concepts__data__flow_data.html">flow data</a> <b>MUST</b> exist for as long as the <a class="el" href="_concepts__data__flow_data.html">flow data</a>. This is also true of post processing usage like retrieving results from the <a class="el" href="_concepts__data__flow_data.html">flow data</a>. Imagine a case where a certain result has been <a class="el" href="_features__lazy_loading.html">lazily loaded</a> &ndash; a call to get that result will require the <a class="el" href="_concepts__flow_elements__flow_element.html">flow element</a> which created it to do the loading, so if the <b>Pipeline</b> has disposed of the <a class="el" href="_concepts__flow_elements__flow_element.html">flow element</a>, there will be an error.</p>
<p>While not a necessity, it is good practice to dispose of each <a class="el" href="_concepts__data__flow_data.html">flow data</a> produced by the <b>Pipeline</b> once it is finished with. </p>
</section></div><!-- PageDoc -->
</div><!-- primary -->
</div><!-- inner-->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<section id="nav-path" class="g-footer g-footer--docs"><!-- id is needed for treeview function! -->
    <p class="g-footer__copyright">Generated by
    <a href="http://www.doxygen.org/index.html">
    <b>doxygen</b></a> 1.8.15
  </p>
</section>
</div>
</main>
</div>
</body>
</html>
